FROM python:3.7.1-alpine3.8

RUN pip install --no-cache-dir \
        docopt \
        jsonpath \
        requests
COPY launch-pyradiomics-containers.py /usr/local/bin
COPY launch-dcmtonrrd-containers.py /usr/local/bin
LABEL org.nrg.commands="[{\"inputs\": [{\"required\": true, \"name\": \"PROJECT\", \"user-settable\": false}, {\"required\": true, \"name\": \"SESSION_ID\", \"user-settable\": false}], \"name\": \"pyradiomics-all-rtstruct\", \"command-line\": \"launch-pyradiomics-containers.py \$XNAT_HOST \$XNAT_USER \$XNAT_PASS #SESSION_ID# #PROJECT#\", \"outputs\": [], \"image\": \"xnat/dicomtonrrd-pyradiomics-batch:1.0\", \"override-entrypoint\": true, \"version\": \"1.0\", \"schema-version\": \"1.0\", \"xnat\": [{\"description\": \"Launch pyradiomics containers on all NRRD files in an RTStruct scan\", \"contexts\": [\"xnat:imageSessionData\"], \"name\": \"pyradiomics-all-rtstruct-session\", \"output-handlers\": [], \"label\": \"Pyradiomics - all RTStruct NRRD files\", \"external-inputs\": [{\"required\": true, \"type\": \"Session\", \"name\": \"session\", \"description\": \"Input session\"}], \"derived-inputs\": [{\"provides-value-for-command-input\": \"PROJECT\", \"name\": \"project\", \"derived-from-xnat-object-property\": \"project-id\", \"required\": true, \"user-settable\": false, \"derived-from-wrapper-input\": \"session\", \"type\": \"string\"}, {\"provides-value-for-command-input\": \"SESSION_ID\", \"name\": \"session-id\", \"derived-from-xnat-object-property\": \"id\", \"required\": true, \"user-settable\": false, \"derived-from-wrapper-input\": \"session\", \"type\": \"string\"}]}], \"mounts\": [], \"type\": \"docker\", \"description\": \"Launch pyradiomics containers on all NRRD files in an RTStruct scan\"}, \
	{\"inputs\": [{\"required\": true, \"name\": \"PROJECT\", \"user-settable\": false}, {\"required\": true, \"name\": \"SESSION_ID\", \"user-settable\": false}], \"name\": \"dcmtonrrd-batch\", \"command-line\": \"launch-dcmtonrrd-containers.py \$XNAT_HOST \$XNAT_USER \$XNAT_PASS #SESSION_ID# #PROJECT#\", \"outputs\": [], \"image\": \"xnat/dicomtonrrd-pyradiomics-batch:1.0\", \"override-entrypoint\": true, \"version\": \"1.0\", \"schema-version\": \"1.0\", \"xnat\": [{\"description\": \"Launch dcmtonrrd containers on all scans in a session.\", \"contexts\": [\"xnat:imageSessionData\"], \"name\": \"dcmtonrrd-session\", \"output-handlers\": [], \"label\": \"Dcmtonrrd - all scans\", \"external-inputs\": [{\"required\": true, \"type\": \"Session\", \"name\": \"session\", \"description\": \"Input session\"}], \"derived-inputs\": [{\"provides-value-for-command-input\": \"PROJECT\", \"name\": \"project\", \"derived-from-xnat-object-property\": \"project-id\", \"required\": true, \"user-settable\": false, \"derived-from-wrapper-input\": \"session\", \"type\": \"string\"}, {\"provides-value-for-command-input\": \"SESSION_ID\", \"name\": \"session-id\", \"derived-from-xnat-object-property\": \"id\", \"required\": true, \"user-settable\": false, \"derived-from-wrapper-input\": \"session\", \"type\": \"string\"}]}], \"mounts\": [], \"type\": \"docker\", \"description\": \"Launch dcmtonrrd containers on all scan files in a session\"}]"
