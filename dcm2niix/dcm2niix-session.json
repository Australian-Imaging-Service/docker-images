{
    "name": "dcm2niix session",
    "description": "Runs dcm2niix on an XNAT scan's DICOM resource from a parent session",
    "docker-image": "xnat/dcm2niix",
    "run": {
        "command-line": "dcm2niix [BIDS] [OTHER_OPTIONS] -o /output /input",
        "mounts": [
            {
                "name": "dicom-in",
                "type": "input",
                "path": "/input",
                "file-input": "scan",
                "resource": "DICOM"
            },
            {
                "name": "nifti-out",
                "type": "output",
                "path": "/output"
            }
        ]
    },
    "inputs": [
        {
            "name": "session",
            "description": "Input session",
            "type": "Session",
            "required": true,
            "matcher": "'DICOM' in @.scans[*].resources[*].label"
        },
        {
            "name": "scan",
            "description": "Input scan",
            "type": "Scan",
            "required": true,
            "parent": "session",
            "matcher": "'DICOM' in @.resources[*].label"
        },
        {
            "name": "bids",
            "description": "Create BIDS metadata file",
            "type": "boolean",
            "required": false,
            "default-value": false,
            "replacement-key": "[BIDS]",
            "command-line-flag": "-b",
            "true-value": "y",
            "false-value": "n"
        },
        {
            "name": "other-options",
            "description": "Other command-line flags to pass to dcm2niix",
            "type": "string",
            "required": false,
            "replacement-key": "[OTHER_OPTIONS]"
        }
    ],
    "outputs": [
        {
            "name": "nifti",
            "description": "The nifti files",
            "type": "Resource",
            "parent": "scan",
            "label": "NIFTI",
            "files": {
                "mount": "nifti-out"
            }
        }
    ]
}
